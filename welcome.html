<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#06011c">

  <link rel="icon" type="image/png" sizes="32x32" href="images/logo-virtual-login.png">
  <link rel="apple-touch-icon" href="images/logo-virtual-login.png">

  <title>Bienvenido Â· VirtualGift</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,400;0,14..32,500;0,14..32,600;0,14..32,700;0,14..32,800;0,14..32,900&display=swap" rel="stylesheet">

  <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script defer src="js/firebase-config.js"></script>
  <script>
    function withAppFlag(url) {
      const isAndroidApp =
        document.documentElement.classList.contains("android-app") ||
        document.body.classList.contains("android-app");
      if (!isAndroidApp) return url;
      if (url.includes("app=android")) return url;
      const parts = url.split("#");
      const base  = parts[0];
      const hash  = parts[1] ? "#" + parts[1] : "";
      const fixed = base.includes("?") ? base + "&app=android" : base + "?app=android";
      return fixed + hash;
    }
  </script>
  <script defer src="js/app-mode.js"></script>

  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --primary:   #8d17fb;
      --primary-2: #70189b;
      --accent:    #68e3ff;
      --bg:        #06011c;
      --card:      rgba(14, 10, 38, 0.92);
      --border:    rgba(255,255,255,0.07);
      --text:      #dcefff;
      --muted:     #7a8fa8;
      --gold:      #ffc837;
      --gold-dim:  rgba(255,200,55,0.12);
      --font:      'Inter', sans-serif;
    }

    html, body {
      height: 100%; min-height: 100vh;
      background: var(--bg);
      color: var(--text);
      font-family: var(--font);
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* ===== FONDO ===== */
    .bg-orbs {
      position: fixed; inset: 0; z-index: 0; overflow: hidden; pointer-events: none;
    }
    .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.45; }
    .orb-1 {
      width: 380px; height: 380px;
      background: radial-gradient(circle, #8d17fb 0%, transparent 70%);
      top: -120px; left: -100px;
      animation: drift1 14s ease-in-out infinite alternate;
    }
    .orb-2 {
      width: 320px; height: 320px;
      background: radial-gradient(circle, #2563eb 0%, transparent 70%);
      bottom: -80px; right: -80px;
      animation: drift2 18s ease-in-out infinite alternate;
    }
    .orb-3 {
      width: 220px; height: 220px;
      background: radial-gradient(circle, #06b6d4 0%, transparent 70%);
      top: 45%; left: 60%;
      animation: drift3 22s ease-in-out infinite alternate;
    }
    @keyframes drift1 { from{transform:translate(0,0) scale(1)} to{transform:translate(40px,30px) scale(1.1)} }
    @keyframes drift2 { from{transform:translate(0,0) scale(1)} to{transform:translate(-30px,-20px) scale(1.08)} }
    @keyframes drift3 { from{transform:translate(0,0) scale(1)} to{transform:translate(-20px,25px) scale(0.92)} }

    .bg-grid {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background-image:
        linear-gradient(rgba(141,23,251,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(141,23,251,0.04) 1px, transparent 1px);
      background-size: 40px 40px;
    }

    /* ===== LAYOUT ===== */
    .welcome-container {
      position: relative; z-index: 1;
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      padding: 24px 16px;
      padding-top: max(24px, env(safe-area-inset-top));
      padding-bottom: max(24px, env(safe-area-inset-bottom));
    }

    /* ===== CARD ===== */
    .welcome-card {
      width: 100%; max-width: 400px;
      background: var(--card);
      border: 1px solid rgba(141,23,251,0.2);
      border-radius: 26px;
      padding: 36px 28px 32px;
      box-shadow:
        0 25px 80px rgba(0,0,0,0.6),
        0 0 0 1px rgba(141,23,251,0.08),
        inset 0 1px 0 rgba(255,255,255,0.05);
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      animation: cardIn 0.5s cubic-bezier(0.34,1.3,0.64,1) both;
    }
    @keyframes cardIn {
      from { opacity:0; transform:translateY(24px) scale(0.97); }
      to   { opacity:1; transform:translateY(0) scale(1); }
    }

    /* ===== LOGO ===== */
    .logo {
      display: flex; flex-direction: column;
      align-items: center; gap: 12px;
      margin-bottom: 28px;
      position: relative;
    }
    .logo-glow {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 130px; height: 130px;
      background: radial-gradient(circle, rgba(141,23,251,0.35) 0%, transparent 70%);
      filter: blur(18px); border-radius: 50%; pointer-events: none;
    }
    .logo img {
      width: 68px; height: 68px; border-radius: 18px; object-fit: contain;
      position: relative; z-index: 1;
      filter: drop-shadow(0 4px 16px rgba(141,23,251,0.5));
    }
    .logo-wordmark {
      font-size: 20px; font-weight: 900; letter-spacing: 2px; color: white;
      position: relative; z-index: 1;
    }
    .logo-wordmark span { color: var(--primary); }

    /* ===== DIVIDER ===== */
    .divider {
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 24px;
    }
    .divider::before, .divider::after {
      content: ''; flex: 1; height: 1px;
      background: linear-gradient(to right, transparent, rgba(255,255,255,0.08));
    }
    .divider::after { transform: scaleX(-1); }
    .divider span {
      font-size: 11px; font-weight: 700;
      color: var(--muted); letter-spacing: 1px; text-transform: uppercase; white-space: nowrap;
    }

    /* ===== USER INFO ===== */
    .user-info { text-align: center; margin-bottom: 20px; }

    .user-avatar-wrap {
      width: 60px; height: 60px; border-radius: 50%; margin: 0 auto 14px;
      background: linear-gradient(135deg, rgba(141,23,251,0.3), rgba(104,227,255,0.2));
      border: 2px solid rgba(141,23,251,0.4);
      display: flex; align-items: center; justify-content: center;
      font-size: 26px;
      box-shadow: 0 0 20px rgba(141,23,251,0.25);
    }

    #userName {
      font-size: 22px; font-weight: 800; color: white;
      line-height: 1.1; margin-bottom: 12px;
    }

    .points-pill {
      display: inline-flex; align-items: center; gap: 7px;
      background: var(--gold-dim);
      border: 1px solid rgba(255,200,55,0.25);
      border-radius: 20px; padding: 6px 14px;
    }
    .points-pill .coin-icon { font-size: 18px; }
    #userPoints { font-size: 18px; font-weight: 800; color: var(--gold); }
    .points-label {
      font-size: 12px; font-weight: 700;
      color: rgba(255,200,55,0.6); text-transform: uppercase; letter-spacing: 0.5px;
    }

    /* ===== MENSAJE ===== */
    #welcome-message {
      font-size: 13.5px; font-weight: 500;
      color: var(--muted); line-height: 1.65;
      text-align: center; margin-bottom: 28px;
    }

    /* ===== BOTÃ“N CONTINUAR ===== */
    #continue-btn {
      width: 100%;
      display: flex; align-items: center; justify-content: center; gap: 10px;
      padding: 15px 24px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-2) 100%);
      border: none; border-radius: 14px;
      color: white; font-size: 16px; font-weight: 800;
      font-family: var(--font); letter-spacing: 0.3px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(141,23,251,0.4);
      transition: all 0.2s ease;
      position: relative; overflow: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    #continue-btn::before {
      content: ''; position: absolute; inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 60%);
    }
    #continue-btn:hover { transform:translateY(-1px); box-shadow:0 8px 28px rgba(141,23,251,0.55); }
    #continue-btn:active { transform: scale(0.98); }
    #continue-btn:disabled { opacity: 0.7; pointer-events: none; }
    #continue-btn svg.arrow { width:18px; height:18px; fill:white; transition:transform 0.2s; }
    #continue-btn:hover svg.arrow { transform: translateX(3px); }

    /* ===== MODAL EMAIL ===== */
    #vg-email-modal {
      position: fixed; inset: 0; z-index: 9999;
      background: rgba(2,5,21,.88);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      display: none; align-items: center; justify-content: center; padding: 20px;
    }
    #vg-email-modal.visible { display: flex !important; }
    .modal-box {
      background: rgba(14,10,38,0.97);
      border: 1px solid rgba(141,23,251,0.25);
      border-radius: 24px; padding: 28px 24px 22px;
      max-width: 320px; width: 100%;
      box-shadow: 0 24px 70px rgba(0,0,0,0.6);
      text-align: center;
      display: flex; flex-direction: column; gap: 18px;
      animation: modalIn .22s cubic-bezier(0.34,1.4,0.64,1) both;
    }
    @keyframes modalIn {
      from { opacity:0; transform:scale(.94) translateY(10px); }
      to   { opacity:1; transform:scale(1) translateY(0); }
    }
    .modal-box .modal-icon { font-size: 2.6em; }
    .modal-box p { font-size:.96em; font-weight:700; color:var(--text); line-height:1.6; margin:0; }
    #vg-email-modal-ok {
      background: linear-gradient(135deg, var(--primary), var(--primary-2));
      color:#fff; border:none; padding:13px 20px; border-radius:14px;
      font-weight:800; cursor:pointer; font-size:.95em; font-family:var(--font);
      box-shadow: 0 4px 16px rgba(141,23,251,0.35);
      transition: transform 0.15s;
    }
    #vg-email-modal-ok:active { transform:scale(0.97); }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 400px) {
      .welcome-card { padding: 28px 20px 26px; border-radius: 22px; }
      .logo img { width: 58px; height: 58px; }
      .logo-wordmark { font-size: 17px; }
      #userName { font-size: 19px; }
      #continue-btn { font-size: 15px; padding: 13px 20px; }
    }

    @media (max-height: 650px) {
      .welcome-card { padding: 22px 20px 20px; }
      .logo { margin-bottom: 18px; }
      .logo img { width: 52px; height: 52px; }
      .user-avatar-wrap { width: 50px; height: 50px; font-size: 22px; }
      #welcome-message { margin-bottom: 18px; font-size: 12.5px; }
    }
  </style>
</head>

<body>

  <div class="bg-orbs" aria-hidden="true">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>
  <div class="bg-grid" aria-hidden="true"></div>

  <div class="welcome-container">
    <div class="welcome-card">

      <div class="logo">
        <div class="logo-glow" aria-hidden="true"></div>
        <img src="images/logo-virtual-login.png" alt="VirtualGift">
        <div class="logo-wordmark">VIRTUAL<span>GIFT</span></div>
      </div>

      <div class="divider"><span>Â¡Hola de nuevo!</span></div>

      <div class="user-info">
        <div class="user-avatar-wrap">ðŸ‘‹</div>
        <div id="userName">Usuario</div>
        <div class="points-pill">
          <span class="coin-icon">ðŸª™</span>
          <span id="userPoints">0</span>
          <span class="points-label">Coins</span>
        </div>
      </div>

      <p id="welcome-message">
        Nos alegra verte de nuevo. Â¡PrepÃ¡rate para ganar recompensas increÃ­bles!
      </p>

      <button id="continue-btn">
        Continuar
        <svg class="arrow" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
      </button>

    </div>
  </div>

  <!-- Modal email no verificado -->
  <div id="vg-email-modal">
    <div class="modal-box">
      <div class="modal-icon">ðŸ“§</div>
      <p>Por favor, verifica tu email para acceder a VirtualGift.</p>
      <button id="vg-email-modal-ok">Entendido</button>
    </div>
  </div>

  <script defer src="js/welcome.js"></script>
</body>
</html>
